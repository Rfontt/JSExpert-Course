function cov_t3n4vxhe(){var path="/home/cvc/\xC1rea de Trabalho/JavaScript/JSEXPERT/TestingJS/project-class-03/test/unitTests/carService.test.js";var hash="4a232d7fb60133b46aab80bdce22f655f88f8651";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/cvc/\xC1rea de Trabalho/JavaScript/JSEXPERT/TestingJS/project-class-03/test/unitTests/carService.test.js",statementMap:{"0":{start:{line:1,column:56},end:{line:1,column:72}},"1":{start:{line:2,column:17},end:{line:2,column:32}},"2":{start:{line:3,column:19},end:{line:3,column:34}},"3":{start:{line:4,column:14},end:{line:4,column:30}},"4":{start:{line:6,column:19},end:{line:6,column:60}},"5":{start:{line:7,column:20},end:{line:7,column:63}},"6":{start:{line:8,column:21},end:{line:8,column:69}},"7":{start:{line:10,column:14},end:{line:14,column:1}},"8":{start:{line:16,column:0},end:{line:142,column:3}},"9":{start:{line:17,column:21},end:{line:17,column:23}},"10":{start:{line:18,column:18},end:{line:18,column:20}},"11":{start:{line:20,column:4},end:{line:24,column:7}},"12":{start:{line:21,column:8},end:{line:23,column:10}},"13":{start:{line:26,column:4},end:{line:28,column:7}},"14":{start:{line:27,column:8},end:{line:27,column:40}},"15":{start:{line:30,column:4},end:{line:32,column:7}},"16":{start:{line:31,column:8},end:{line:31,column:26}},"17":{start:{line:34,column:4},end:{line:39,column:7}},"18":{start:{line:35,column:21},end:{line:35,column:36}},"19":{start:{line:36,column:23},end:{line:36,column:66}},"20":{start:{line:38,column:8},end:{line:38,column:60}},"21":{start:{line:41,column:4},end:{line:55,column:6}},"22":{start:{line:42,column:28},end:{line:42,column:50}},"23":{start:{line:43,column:25},end:{line:43,column:26}},"24":{start:{line:45,column:8},end:{line:48,column:27}},"25":{start:{line:50,column:23},end:{line:50,column:62}},"26":{start:{line:51,column:25},end:{line:51,column:53}},"27":{start:{line:53,column:8},end:{line:53,column:74}},"28":{start:{line:54,column:8},end:{line:54,column:45}},"29":{start:{line:57,column:4},end:{line:79,column:7}},"30":{start:{line:58,column:20},end:{line:58,column:34}},"31":{start:{line:59,column:28},end:{line:59,column:65}},"32":{start:{line:61,column:8},end:{line:61,column:38}},"33":{start:{line:63,column:8},end:{line:66,column:23}},"34":{start:{line:68,column:8},end:{line:71,column:9}},"35":{start:{line:73,column:23},end:{line:73,column:68}},"36":{start:{line:74,column:25},end:{line:74,column:28}},"37":{start:{line:76,column:8},end:{line:76,column:63}},"38":{start:{line:77,column:8},end:{line:77,column:81}},"39":{start:{line:78,column:8},end:{line:78,column:51}},"40":{start:{line:81,column:4},end:{line:104,column:7}},"41":{start:{line:82,column:25},end:{line:82,column:59}},"42":{start:{line:83,column:8},end:{line:83,column:26}},"43":{start:{line:85,column:28},end:{line:85,column:65}},"44":{start:{line:86,column:8},end:{line:86,column:33}},"45":{start:{line:88,column:29},end:{line:88,column:30}},"46":{start:{line:90,column:8},end:{line:93,column:54}},"47":{start:{line:93,column:20},end:{line:93,column:53}},"48":{start:{line:96,column:25},end:{line:96,column:64}},"49":{start:{line:97,column:23},end:{line:101,column:9}},"50":{start:{line:103,column:8},end:{line:103,column:50}},"51":{start:{line:106,column:4},end:{line:141,column:7}},"52":{start:{line:107,column:20},end:{line:107,column:34}},"53":{start:{line:108,column:28},end:{line:112,column:9}},"54":{start:{line:114,column:25},end:{line:114,column:59}},"55":{start:{line:115,column:8},end:{line:115,column:26}},"56":{start:{line:117,column:29},end:{line:117,column:30}},"57":{start:{line:118,column:24},end:{line:118,column:48}},"58":{start:{line:120,column:20},end:{line:120,column:41}},"59":{start:{line:121,column:8},end:{line:121,column:45}},"60":{start:{line:123,column:8},end:{line:126,column:23}},"61":{start:{line:128,column:31},end:{line:128,column:70}},"62":{start:{line:129,column:23},end:{line:131,column:9}},"63":{start:{line:133,column:25},end:{line:138,column:10}},"64":{start:{line:140,column:8},end:{line:140,column:50}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:16,column:35},end:{line:16,column:36}},loc:{start:{line:16,column:41},end:{line:142,column:1}},line:16},"1":{name:"(anonymous_1)",decl:{start:{line:20,column:11},end:{line:20,column:12}},loc:{start:{line:20,column:17},end:{line:24,column:5}},line:20},"2":{name:"(anonymous_2)",decl:{start:{line:26,column:15},end:{line:26,column:16}},loc:{start:{line:26,column:21},end:{line:28,column:5}},line:26},"3":{name:"(anonymous_3)",decl:{start:{line:30,column:14},end:{line:30,column:15}},loc:{start:{line:30,column:20},end:{line:32,column:5}},line:30},"4":{name:"(anonymous_4)",decl:{start:{line:34,column:57},end:{line:34,column:58}},loc:{start:{line:34,column:63},end:{line:39,column:5}},line:34},"5":{name:"(anonymous_5)",decl:{start:{line:41,column:64},end:{line:41,column:65}},loc:{start:{line:41,column:70},end:{line:55,column:5}},line:41},"6":{name:"(anonymous_6)",decl:{start:{line:57,column:64},end:{line:57,column:65}},loc:{start:{line:57,column:76},end:{line:79,column:5}},line:57},"7":{name:"(anonymous_7)",decl:{start:{line:81,column:98},end:{line:81,column:99}},loc:{start:{line:81,column:109},end:{line:104,column:5}},line:81},"8":{name:"(anonymous_8)",decl:{start:{line:93,column:14},end:{line:93,column:15}},loc:{start:{line:93,column:20},end:{line:93,column:53}},line:93},"9":{name:"(anonymous_9)",decl:{start:{line:106,column:85},end:{line:106,column:86}},loc:{start:{line:106,column:96},end:{line:141,column:5}},line:106}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"4a232d7fb60133b46aab80bdce22f655f88f8651"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_t3n4vxhe=function(){return actualCoverage;};}return actualCoverage;}cov_t3n4vxhe();const{describe,it,before,beforeEach,afterEach}=(cov_t3n4vxhe().s[0]++,require('mocha'));const{join}=(cov_t3n4vxhe().s[1]++,require('path'));const{expect}=(cov_t3n4vxhe().s[2]++,require('chai'));const sinon=(cov_t3n4vxhe().s[3]++,require('sinon'));const CarService=(cov_t3n4vxhe().s[4]++,require('./../../src/service/carService'));const Transaction=(cov_t3n4vxhe().s[5]++,require('./../../src/entities/transaction'));const carsDataBase=(cov_t3n4vxhe().s[6]++,join(__dirname,'./../../database','cars.json'));const mocks=(cov_t3n4vxhe().s[7]++,{validCarCategory:require('./../mocks/valid-carCategory.json'),validCar:require('./../mocks/valid-car.json'),validCustomer:require('./../mocks/valid-customer.json')});cov_t3n4vxhe().s[8]++;describe('CarService Suite Tests',()=>{cov_t3n4vxhe().f[0]++;let carService=(cov_t3n4vxhe().s[9]++,{});let sandbox=(cov_t3n4vxhe().s[10]++,{});cov_t3n4vxhe().s[11]++;before(()=>{cov_t3n4vxhe().f[1]++;cov_t3n4vxhe().s[12]++;carService=new CarService({cars:carsDataBase});});cov_t3n4vxhe().s[13]++;beforeEach(()=>{cov_t3n4vxhe().f[2]++;cov_t3n4vxhe().s[14]++;sandbox=sinon.createSandbox();});cov_t3n4vxhe().s[15]++;afterEach(()=>{cov_t3n4vxhe().f[3]++;cov_t3n4vxhe().s[16]++;sandbox.restore();});cov_t3n4vxhe().s[17]++;it('Should retries a random position from an array',()=>{cov_t3n4vxhe().f[4]++;const data=(cov_t3n4vxhe().s[18]++,[0,1,2,3,4]);const result=(cov_t3n4vxhe().s[19]++,carService.getRandomPositionFromArray(data));cov_t3n4vxhe().s[20]++;expect(result).to.be.lte(data.length).and.be.gte(0);});cov_t3n4vxhe().s[21]++;it('Should choose the first id from carIds in carCategory',()=>{cov_t3n4vxhe().f[5]++;const carCategory=(cov_t3n4vxhe().s[22]++,mocks.validCarCategory);const carIndex=(cov_t3n4vxhe().s[23]++,0);cov_t3n4vxhe().s[24]++;sandbox.stub(carService,carService.getRandomPositionFromArray.name).returns(carIndex);const result=(cov_t3n4vxhe().s[25]++,carService.chooseRandomCar(carCategory));const expected=(cov_t3n4vxhe().s[26]++,carCategory.carIds[carIndex]);cov_t3n4vxhe().s[27]++;expect(carService.getRandomPositionFromArray.calledOnce).to.be.ok;cov_t3n4vxhe().s[28]++;expect(result).to.be.equal(expected);});cov_t3n4vxhe().s[29]++;it('Given a carCategory it should return an available car',async()=>{cov_t3n4vxhe().f[6]++;const car=(cov_t3n4vxhe().s[30]++,mocks.validCar);const carCategory=(cov_t3n4vxhe().s[31]++,Object.create(mocks.validCarCategory));cov_t3n4vxhe().s[32]++;carCategory.carIds=[car.id];cov_t3n4vxhe().s[33]++;sandbox.stub(carService.carRepository,carService.carRepository.find.name).resolves(car);cov_t3n4vxhe().s[34]++;sandbox.spy(carService,carService.chooseRandomCar.name);const result=(cov_t3n4vxhe().s[35]++,await carService.getAvailableCar(carCategory));const expected=(cov_t3n4vxhe().s[36]++,car);cov_t3n4vxhe().s[37]++;expect(carService.chooseRandomCar.calledOnce).to.be.ok;cov_t3n4vxhe().s[38]++;expect(carService.carRepository.find.calledWithExactly(car.id)).to.be.ok;cov_t3n4vxhe().s[39]++;expect(result).to.be.deep.equals(expected);});cov_t3n4vxhe().s[40]++;it('Given a carCategory, customer and numberOfDays it should calculate final amount in real',async()=>{cov_t3n4vxhe().f[7]++;const customer=(cov_t3n4vxhe().s[41]++,Object.create(mocks.validCustomer));cov_t3n4vxhe().s[42]++;customer.age=50;const carCategory=(cov_t3n4vxhe().s[43]++,Object.create(mocks.validCarCategory));cov_t3n4vxhe().s[44]++;carCategory.price=37.6;const numberOfDays=(cov_t3n4vxhe().s[45]++,5);cov_t3n4vxhe().s[46]++;sandbox.stub(carService,"taxesBasedOnAge").get(()=>{cov_t3n4vxhe().f[8]++;cov_t3n4vxhe().s[47]++;return[{from:40,to:50,then:1.3}];});const expected=(cov_t3n4vxhe().s[48]++,carService.currentFormat.format(244.40));const result=(cov_t3n4vxhe().s[49]++,carService.calculateFinalPrice(customer,carCategory,numberOfDays));cov_t3n4vxhe().s[50]++;expect(result).to.be.deep.equal(expected);});cov_t3n4vxhe().s[51]++;it('Given a customer and a car category it should return a transaction receipt',async()=>{cov_t3n4vxhe().f[9]++;const car=(cov_t3n4vxhe().s[52]++,mocks.validCar);const carCategory=(cov_t3n4vxhe().s[53]++,{...mocks.validCarCategory,price:37.6,carIds:car.id});const customer=(cov_t3n4vxhe().s[54]++,Object.create(mocks.validCustomer));cov_t3n4vxhe().s[55]++;customer.age=20;const numberOfDays=(cov_t3n4vxhe().s[56]++,5);const dueDate=(cov_t3n4vxhe().s[57]++,"10 de novembro de 2020");const now=(cov_t3n4vxhe().s[58]++,new Date(2020,10,5));cov_t3n4vxhe().s[59]++;sandbox.useFakeTimers(now.getTime());cov_t3n4vxhe().s[60]++;sandbox.stub(carService.carRepository,carService.carRepository.find.name).resolves(car);const expectedAmount=(cov_t3n4vxhe().s[61]++,carService.currentFormat.format(206.80));const result=(cov_t3n4vxhe().s[62]++,await carService.rent(customer,carCategory,numberOfDays));const expected=(cov_t3n4vxhe().s[63]++,new Transaction({customer,car,dueDate,amount:expectedAmount}));cov_t3n4vxhe().s[64]++;expect(result).to.be.deep.equal(expected);});});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhclNlcnZpY2UudGVzdC5qcyJdLCJuYW1lcyI6WyJkZXNjcmliZSIsIml0IiwiYmVmb3JlIiwiYmVmb3JlRWFjaCIsImFmdGVyRWFjaCIsInJlcXVpcmUiLCJqb2luIiwiZXhwZWN0Iiwic2lub24iLCJDYXJTZXJ2aWNlIiwiVHJhbnNhY3Rpb24iLCJjYXJzRGF0YUJhc2UiLCJfX2Rpcm5hbWUiLCJtb2NrcyIsInZhbGlkQ2FyQ2F0ZWdvcnkiLCJ2YWxpZENhciIsInZhbGlkQ3VzdG9tZXIiLCJjYXJTZXJ2aWNlIiwic2FuZGJveCIsImNhcnMiLCJjcmVhdGVTYW5kYm94IiwicmVzdG9yZSIsImRhdGEiLCJyZXN1bHQiLCJnZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheSIsInRvIiwiYmUiLCJsdGUiLCJsZW5ndGgiLCJhbmQiLCJndGUiLCJjYXJDYXRlZ29yeSIsImNhckluZGV4Iiwic3R1YiIsIm5hbWUiLCJyZXR1cm5zIiwiY2hvb3NlUmFuZG9tQ2FyIiwiZXhwZWN0ZWQiLCJjYXJJZHMiLCJjYWxsZWRPbmNlIiwib2siLCJlcXVhbCIsImNhciIsIk9iamVjdCIsImNyZWF0ZSIsImlkIiwiY2FyUmVwb3NpdG9yeSIsImZpbmQiLCJyZXNvbHZlcyIsInNweSIsImdldEF2YWlsYWJsZUNhciIsImNhbGxlZFdpdGhFeGFjdGx5IiwiZGVlcCIsImVxdWFscyIsImN1c3RvbWVyIiwiYWdlIiwicHJpY2UiLCJudW1iZXJPZkRheXMiLCJnZXQiLCJmcm9tIiwidGhlbiIsImN1cnJlbnRGb3JtYXQiLCJmb3JtYXQiLCJjYWxjdWxhdGVGaW5hbFByaWNlIiwiZHVlRGF0ZSIsIm5vdyIsIkRhdGUiLCJ1c2VGYWtlVGltZXJzIiwiZ2V0VGltZSIsImV4cGVjdGVkQW1vdW50IiwicmVudCIsImFtb3VudCJdLCJtYXBwaW5ncyI6IjR0TUFlWTt1RkFmWixLQUFNLENBQUVBLFFBQUYsQ0FBWUMsRUFBWixDQUFnQkMsTUFBaEIsQ0FBd0JDLFVBQXhCLENBQW9DQyxTQUFw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S0FBTXBCLENBQUFBLFFBQVEseUJBQUcsR0FBSTNCLENBQUFBLFdBQUosQ0FBZ0IsQ0FDN0I0QyxRQUQ2QixDQUU3QlosR0FGNkIsQ0FHN0JzQixPQUg2QixDQUk3Qk8sTUFBTSxDQUFFRixjQUpxQixDQUFoQixDQUFILENBQWQsQ0EzQndGLHVCQWtDeEY5RCxNQUFNLENBQUNnQixNQUFELENBQU4sQ0FBZUUsRUFBZixDQUFrQkMsRUFBbEIsQ0FBcUIwQixJQUFyQixDQUEwQlgsS0FBMUIsQ0FBZ0NKLFFBQWhDLEVBQ0gsQ0FuQ0MsQ0FBRixDQW9DSCxDQTlITyxDQUFSIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBkZXNjcmliZSwgaXQsIGJlZm9yZSwgYmVmb3JlRWFjaCwgYWZ0ZXJFYWNoIH0gPSByZXF1aXJlKCdtb2NoYScpO1xuY29uc3QgeyBqb2luIH0gPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCB7IGV4cGVjdCB9ID0gcmVxdWlyZSgnY2hhaScpO1xuY29uc3Qgc2lub24gPSByZXF1aXJlKCdzaW5vbicpO1xuXG5jb25zdCBDYXJTZXJ2aWNlID0gcmVxdWlyZSgnLi8uLi8uLi9zcmMvc2VydmljZS9jYXJTZXJ2aWNlJyk7XG5jb25zdCBUcmFuc2FjdGlvbiA9IHJlcXVpcmUoJy4vLi4vLi4vc3JjL2VudGl0aWVzL3RyYW5zYWN0aW9uJyk7XG5jb25zdCBjYXJzRGF0YUJhc2UgPSBqb2luKF9fZGlybmFtZSwgJy4vLi4vLi4vZGF0YWJhc2UnLCAnY2Fycy5qc29uJyk7XG5cbmNvbnN0IG1vY2tzID0ge1xuICAgIHZhbGlkQ2FyQ2F0ZWdvcnk6IHJlcXVpcmUoJy4vLi4vbW9ja3MvdmFsaWQtY2FyQ2F0ZWdvcnkuanNvbicpLFxuICAgIHZhbGlkQ2FyOiByZXF1aXJlKCcuLy4uL21vY2tzL3ZhbGlkLWNhci5qc29uJyksXG4gICAgdmFsaWRDdXN0b21lcjogcmVxdWlyZSgnLi8uLi9tb2Nrcy92YWxpZC1jdXN0b21lci5qc29uJylcbn1cblxuZGVzY3JpYmUoJ0NhclNlcnZpY2UgU3VpdGUgVGVzdHMnLCAoKSA9PiB7XG4gICAgbGV0IGNhclNlcnZpY2UgPSB7fTtcbiAgICBsZXQgc2FuZGJveCA9IHt9O1xuXG4gICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgY2FyU2VydmljZSA9IG5ldyBDYXJTZXJ2aWNlKHtcbiAgICAgICAgICAgIGNhcnM6IGNhcnNEYXRhQmFzZVxuICAgICAgICB9KVxuICAgIH0pO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgIHNhbmRib3ggPSBzaW5vbi5jcmVhdGVTYW5kYm94KCk7XG4gICAgfSk7XG5cbiAgICBhZnRlckVhY2goKCkgPT4ge1xuICAgICAgICBzYW5kYm94LnJlc3RvcmUoKTtcbiAgICB9KTtcblxuICAgIGl0KCdTaG91bGQgcmV0cmllcyBhIHJhbmRvbSBwb3NpdGlvbiBmcm9tIGFuIGFycmF5JywgKCkgPT4ge1xuICAgICAgICBjb25zdCBkYXRhID0gWzAsIDEsIDIsIDMsIDRdO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBjYXJTZXJ2aWNlLmdldFJhbmRvbVBvc2l0aW9uRnJvbUFycmF5KGRhdGEpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLmx0ZShkYXRhLmxlbmd0aCkuYW5kLmJlLmd0ZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdTaG91bGQgY2hvb3NlIHRoZSBmaXJzdCBpZCBmcm9tIGNhcklkcyBpbiBjYXJDYXRlZ29yeScsICgpID0+IHtcbiAgICAgICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSBtb2Nrcy52YWxpZENhckNhdGVnb3J5O1xuICAgICAgICBjb25zdCBjYXJJbmRleCA9IDA7XG5cbiAgICAgICAgc2FuZGJveC5zdHViKFxuICAgICAgICAgICAgY2FyU2VydmljZSxcbiAgICAgICAgICAgIGNhclNlcnZpY2UuZ2V0UmFuZG9tUG9zaXRpb25Gcm9tQXJyYXkubmFtZVxuICAgICAgICApLnJldHVybnMoY2FySW5kZXgpXG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gY2FyU2VydmljZS5jaG9vc2VSYW5kb21DYXIoY2FyQ2F0ZWdvcnkpO1xuICAgICAgICBjb25zdCBleHBlY3RlZCA9IGNhckNhdGVnb3J5LmNhcklkc1tjYXJJbmRleF07XG4gICAgICAgIFxuICAgICAgICBleHBlY3QoY2FyU2VydmljZS5nZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheS5jYWxsZWRPbmNlKS50by5iZS5vaztcbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZXF1YWwoZXhwZWN0ZWQpO1xuICAgIH0pXG5cbiAgICBpdCgnR2l2ZW4gYSBjYXJDYXRlZ29yeSBpdCBzaG91bGQgcmV0dXJuIGFuIGF2YWlsYWJsZSBjYXInLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNhciA9IG1vY2tzLnZhbGlkQ2FyO1xuICAgICAgICBjb25zdCBjYXJDYXRlZ29yeSA9IE9iamVjdC5jcmVhdGUobW9ja3MudmFsaWRDYXJDYXRlZ29yeSk7XG5cbiAgICAgICAgY2FyQ2F0ZWdvcnkuY2FySWRzID0gW2Nhci5pZF07XG5cbiAgICAgICAgc2FuZGJveC5zdHViKFxuICAgICAgICAgICAgY2FyU2VydmljZS5jYXJSZXBvc2l0b3J5LFxuICAgICAgICAgICAgY2FyU2VydmljZS5jYXJSZXBvc2l0b3J5LmZpbmQubmFtZSxcbiAgICAgICAgKS5yZXNvbHZlcyhjYXIpXG5cbiAgICAgICAgc2FuZGJveC5zcHkoXG4gICAgICAgICAgICBjYXJTZXJ2aWNlLFxuICAgICAgICAgICAgY2FyU2VydmljZS5jaG9vc2VSYW5kb21DYXIubmFtZSxcbiAgICAgICAgKVxuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhclNlcnZpY2UuZ2V0QXZhaWxhYmxlQ2FyKGNhckNhdGVnb3J5KTtcbiAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSBjYXI7XG5cbiAgICAgICAgZXhwZWN0KGNhclNlcnZpY2UuY2hvb3NlUmFuZG9tQ2FyLmNhbGxlZE9uY2UpLnRvLmJlLm9rO1xuICAgICAgICBleHBlY3QoY2FyU2VydmljZS5jYXJSZXBvc2l0b3J5LmZpbmQuY2FsbGVkV2l0aEV4YWN0bHkoY2FyLmlkKSkudG8uYmUub2s7XG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLmRlZXAuZXF1YWxzKGV4cGVjdGVkKTtcbiAgICB9KTtcblxuICAgIGl0KCdHaXZlbiBhIGNhckNhdGVnb3J5LCBjdXN0b21lciBhbmQgbnVtYmVyT2ZEYXlzIGl0IHNob3VsZCBjYWxjdWxhdGUgZmluYWwgYW1vdW50IGluIHJlYWwnLCBhc3luYygpID0+IHtcbiAgICAgICAgY29uc3QgY3VzdG9tZXIgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ3VzdG9tZXIpO1xuICAgICAgICBjdXN0b21lci5hZ2UgPSA1MDtcblxuICAgICAgICBjb25zdCBjYXJDYXRlZ29yeSA9IE9iamVjdC5jcmVhdGUobW9ja3MudmFsaWRDYXJDYXRlZ29yeSk7XG4gICAgICAgIGNhckNhdGVnb3J5LnByaWNlID0gMzcuNjtcblxuICAgICAgICBjb25zdCBudW1iZXJPZkRheXMgPSA1O1xuXG4gICAgICAgIHNhbmRib3guc3R1YihcbiAgICAgICAgICAgIGNhclNlcnZpY2UsXG4gICAgICAgICAgICBcInRheGVzQmFzZWRPbkFnZVwiXG4gICAgICAgICkuZ2V0KCgpID0+IFt7IGZyb206IDQwLCB0bzogNTAsIHRoZW46IDEuMyB9XSlcbiAgICAgICAgXG5cbiAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSBjYXJTZXJ2aWNlLmN1cnJlbnRGb3JtYXQuZm9ybWF0KDI0NC40MCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGNhclNlcnZpY2UuY2FsY3VsYXRlRmluYWxQcmljZShcbiAgICAgICAgICAgIGN1c3RvbWVyLFxuICAgICAgICAgICAgY2FyQ2F0ZWdvcnksXG4gICAgICAgICAgICBudW1iZXJPZkRheXNcbiAgICAgICAgKVxuXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLmRlZXAuZXF1YWwoZXhwZWN0ZWQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ0dpdmVuIGEgY3VzdG9tZXIgYW5kIGEgY2FyIGNhdGVnb3J5IGl0IHNob3VsZCByZXR1cm4gYSB0cmFuc2FjdGlvbiByZWNlaXB0JywgYXN5bmMoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNhciA9IG1vY2tzLnZhbGlkQ2FyO1xuICAgICAgICBjb25zdCBjYXJDYXRlZ29yeSA9IHtcbiAgICAgICAgICAgIC4uLm1vY2tzLnZhbGlkQ2FyQ2F0ZWdvcnksXG4gICAgICAgICAgICBwcmljZTogMzcuNixcbiAgICAgICAgICAgIGNhcklkczogKGNhci5pZClcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBjdXN0b21lciA9IE9iamVjdC5jcmVhdGUobW9ja3MudmFsaWRDdXN0b21lcik7XG4gICAgICAgIGN1c3RvbWVyLmFnZSA9IDIwO1xuXG4gICAgICAgIGNvbnN0IG51bWJlck9mRGF5cyA9IDU7XG4gICAgICAgIGNvbnN0IGR1ZURhdGUgPSBcIjEwIGRlIG5vdmVtYnJvIGRlIDIwMjBcIlxuXG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKDIwMjAsIDEwLCA1KTtcbiAgICAgICAgc2FuZGJveC51c2VGYWtlVGltZXJzKG5vdy5nZXRUaW1lKCkpO1xuXG4gICAgICAgIHNhbmRib3guc3R1YihcbiAgICAgICAgICAgIGNhclNlcnZpY2UuY2FyUmVwb3NpdG9yeSxcbiAgICAgICAgICAgIGNhclNlcnZpY2UuY2FyUmVwb3NpdG9yeS5maW5kLm5hbWVcbiAgICAgICAgKS5yZXNvbHZlcyhjYXIpXG5cbiAgICAgICAgY29uc3QgZXhwZWN0ZWRBbW91bnQgPSBjYXJTZXJ2aWNlLmN1cnJlbnRGb3JtYXQuZm9ybWF0KDIwNi44MCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhclNlcnZpY2UucmVudChcbiAgICAgICAgICAgIGN1c3RvbWVyLCBjYXJDYXRlZ29yeSwgbnVtYmVyT2ZEYXlzXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSBuZXcgVHJhbnNhY3Rpb24oe1xuICAgICAgICAgICAgY3VzdG9tZXIsXG4gICAgICAgICAgICBjYXIsXG4gICAgICAgICAgICBkdWVEYXRlLFxuICAgICAgICAgICAgYW1vdW50OiBleHBlY3RlZEFtb3VudCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZGVlcC5lcXVhbChleHBlY3RlZCk7XG4gICAgfSk7XG59KTsiXX0=